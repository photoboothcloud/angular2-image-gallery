<div class="outerContainer" (window:resize)="onResize()" *ngIf="showViewer" [@showViewerTransition]="showViewer">


    <img [ngClass]="{'activeArrow': leftArrowActive}" class="arrow left"
         src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0cHgiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjx0aXRsZS8+PGRlc2MvPiAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgaWQ9Im1pdSIgc3Ryb2tlPSIjNTU1IiBzdHJva2Utd2lkdGg9IjAuMiI+ICAgICA8ZyBpZD0iQXJ0Ym9hcmQtMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTM5NS4wMDAwMDAsIC0xOTEuMDAwMDAwKSI+PGcgaWQ9InNsaWNlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTUuMDAwMDAwLCAxMTkuMDAwMDAwKSIvPjxwYXRoICAgICAgIGQ9Ik0zOTYsMjAyLjUgQzM5NiwxOTYuMTQ4NzI1IDQwMS4xNDg3MjUsMTkxIDQwNy41LDE5MSBDNDEzLjg1MTI3NSwxOTEgNDE5LDE5Ni4xNDg3MjUgNDE5LDIwMi41IEM0MTksMjA4Ljg1MTI3NSA0MTMuODUxMjc1LDIxNCA0MDcuNSwyMTQgQzQwMS4xNDg3MjUsMjE0IDM5NiwyMDguODUxMjc1IDM5NiwyMDIuNSBaIE00MDguNjU2ODU0LDE5Ni44NDMxNDYgTDQxMC4wNzEwNjgsMTk4LjI1NzM1OSBMNDA1LjgyODQyNywyMDIuNSBMNDEwLjA3MTA2OCwyMDYuNzQyNjQxIEw0MDguNjU2ODU0LDIwOC4xNTY4NTQgTDQwMywyMDIuNSBMNDA4LjY1Njg1NCwxOTYuODQzMTQ2IFoiICAgICAgIGZpbGw9IiNhYWEiICAgICAgIGlkPSJjaXJjbGUtYmFjay1hcnJvdy1nbHlwaCIvPjwvZz4gICA8L2c+IDwvc3ZnPg=="
         [hidden]="!leftArrowVisible" (click)="navigate(-1, false)"/>
    <img [ngClass]="{'activeArrow': rightArrowActive}" class="arrow right"
         src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0cHgiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjx0aXRsZS8+PGRlc2MvPjxkZWZzLz4gICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGlkPSJtaXUiIHN0cm9rZT0iIzU1NSIgc3Ryb2tlLXdpZHRoPSIwLjIiPiAgICAgPGcgaWQ9IkFydGJvYXJkLTEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00NjcuMDAwMDAwLCAtMTkxLjAwMDAwMCkiPjxnIGlkPSJzbGljZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE1LjAwMDAwMCwgMTE5LjAwMDAwMCkiLz48cGF0aCAgICAgICBkPSJNNDY4LDIwMi41IEM0NjgsMTk2LjE0ODcyNSA0NzMuMTQ4NzI1LDE5MSA0NzkuNSwxOTEgQzQ4NS44NTEyNzUsMTkxIDQ5MSwxOTYuMTQ4NzI1IDQ5MSwyMDIuNSBDNDkxLDIwOC44NTEyNzUgNDg1Ljg1MTI3NSwyMTQgNDc5LjUsMjE0IEM0NzMuMTQ4NzI1LDIxNCA0NjgsMjA4Ljg1MTI3NSA0NjgsMjAyLjUgWiBNNDgwLjY1Njg1NCwxOTYuODQzMTQ2IEw0ODIuMDcxMDY4LDE5OC4yNTczNTkgTDQ3Ny44Mjg0MjcsMjAyLjUgTDQ4Mi4wNzEwNjgsMjA2Ljc0MjY0MSBMNDgwLjY1Njg1NCwyMDguMTU2ODU0IEw0NzUsMjAyLjUgTDQ4MC42NTY4NTQsMTk2Ljg0MzE0NiBaIiAgICAgICBmaWxsPSIjYWFhIiAgICAgICBpZD0iY2lyY2xlLW5leHQtYXJyb3ctZGlzY2xvc3VyZS1nbHlwaCIgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDc5LjUwMDAwMCwgMjAyLjUwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNDc5LjUwMDAwMCwgLTIwMi41MDAwMDApICIvPjwvZz4gICA8L2c+IDwvc3ZnPg=="
         [hidden]="!rightArrowVisible" (click)="navigate(1, false)"/>

    <div class="buttonContainer">
        <img class="action close"
             src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwcHgiIGlkPSJMYXllcl8xIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MTIgNTEyOyIgdmVyc2lvbj0iMS4xIiBmaWxsPSIjYWFhIiB2aWV3Qm94PSIwIDAgNTEyIDUxMiIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPiAgPHBhdGggICAgc3Ryb2tlLXdpZHRoPSIzMCIgc3Ryb2tlPSIjNDQ0IiAgICBkPSJNNDM3LjUsMzg2LjZMMzA2LjksMjU2bDEzMC42LTEzMC42YzE0LjEtMTQuMSwxNC4xLTM2LjgsMC01MC45Yy0xNC4xLTE0LjEtMzYuOC0xNC4xLTUwLjksMEwyNTYsMjA1LjFMMTI1LjQsNzQuNSAgYy0xNC4xLTE0LjEtMzYuOC0xNC4xLTUwLjksMGMtMTQuMSwxNC4xLTE0LjEsMzYuOCwwLDUwLjlMMjA1LjEsMjU2TDc0LjUsMzg2LjZjLTE0LjEsMTQuMS0xNC4xLDM2LjgsMCw1MC45ICBjMTQuMSwxNC4xLDM2LjgsMTQuMSw1MC45LDBMMjU2LDMwNi45bDEzMC42LDEzMC42YzE0LjEsMTQuMSwzNi44LDE0LjEsNTAuOSwwQzQ1MS41LDQyMy40LDQ1MS41LDQwMC42LDQzNy41LDM4Ni42eiIvPjwvc3ZnPg=="
             (click)="closeViewer()"/>
    </div>

    <div class="buttonContainer commentButtonContainer">
       <img class="action" 
            src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAC4jAAAuIwF4pT92AAAGWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTA0LTI3VDIyOjMxOjA1KzAyOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wNC0yOVQxMjoxMTowMiswMjowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wNC0yOVQxMjoxMTowMiswMjowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxMjk4ZmNmYS05ZWQ1LTQ5ODQtYjZiMS1jZjdhNzczYjNjNGEiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDphY2FjYWUyYy01YjNmLTgxNGQtOTU4OC05Yzk2ZmYwZDVjY2EiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpmZWM4M2JlNy04ZWIxLTQ2ZDMtYTAwNi04N2FjY2UwNzEzYjQiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmZlYzgzYmU3LThlYjEtNDZkMy1hMDA2LTg3YWNjZTA3MTNiNCIgc3RFdnQ6d2hlbj0iMjAxOS0wNC0yN1QyMjozMTowNSswMjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjb252ZXJ0ZWQiIHN0RXZ0OnBhcmFtZXRlcnM9ImZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjEyOThmY2ZhLTllZDUtNDk4NC1iNmIxLWNmN2E3NzNiM2M0YSIgc3RFdnQ6d2hlbj0iMjAxOS0wNC0yOVQxMjoxMTowMiswMjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PigSLrgAAAOYSURBVHic7ZyxrhJBFIb/BTSxMFbGytLkFpAQacDQ8irb+wTqC2i/CQ9C6EiUTptLZcPGyliZa2KCASxYriuwMDPMnD0L/5fckEzuMrPz7TmzMztstF6vQfRQK7sB5H8oRBkUogwKUQaFKINClEEhymic+ofBYHComJMXM6LdgvF4fPSAk0J2oAg7tv21J6YIm5RFGe4Y952pkINfGEXG4q+Kgn4xkmKbsu6p1Wq4ublBv993/YqLZTqdYjabYbVaWR9rEiF7Zuv1OmUcodfrodlsolbb696TUeJ021uv1ynjBN1uF42GfQJyEtJut10Ouzo6nY71MRQSkFarZX2Mk5Dlculy2NXh0k9cOlEGhSiDQpRBIcqgEGU4L53YkiSJVFXBiOM4eB0iEXIJMgCZ8xBNWXEcR9g8G6jinwgcQ5QhNoYA/0JeIhf7RDLlMkKUQSHKoBBlUIgyRAf1LecOktlNwWsAH7KiZwC+29Sp9cZCWoiXrUS5zn3v4TtUIZKytF6Ntkich1iEXIqU0HBx0QIuLipD4jykB/Uq7z0V2dvMeYgySpmHbNnNyfmUoOkmQDLligs51tGaJOSJ4/iFlBTxlFXRAf6rVEUcQ5QhnbJeAfikLEoeAPhTdiO2SAv5KFxf5eBalgVcy7pCuJZlAdeylMG1LBTP5vPlBzqqCeAWwFMAvwH8ysofA7gD8CgrP8RzAN/y9SdJ8gbAW9u2u1Dq0okJRVfliav1Nvv8sVN+l30WyQByMnL1vIOQEE4MlVFKhFTtjos7F68YcSFViw5Ats3qB/VDnPvcROtzF6CEfVm+8/G536dtjsS1LAu4lqWHnwCeSFTEuywzRGQAFKIOClEGhSiDQpTh+oq/he+GkA1OQiaTyUPfDSEbnITM53PPzSBbnIQsFguMRiPfbSFwFLJarZCmKUajEd+/6BmTpZMIBb+NSNMUw+HQb4sUczG7Ti4FTa9nqvIvn7wSWopNhFBKRpIkwcTYpixKyRFCissYElX8zXBe3yrnWwoHdTuCS3F+YliFJ4AmHVV0HkeOPTgNSJLES59UcteJKQEvmpcAPu8W+pDClOXGFwRKXxRyHt6lXHTKEqJwTHGBEeIHb/MzCvGHFykU4pezpVCIf86S4jSoa9ugrJDCZ0inYISEwylSKCQs1lIoJDxWUihEBmMpFCKHkZRovRZ52SYxhBGiDApRBoUog0KUQSHKoBBlUIgy/gJAUt9THJMDbgAAAABJRU5ErkJggg=="
            (click)="commentViewer()" /> 

    </div>

    <div class="imageContainer"
         (click)="showNavigationArrows()"
         (swipeleft)="navigate(1, $event)"
         (swiperight)="navigate(-1, $event)"
         (pan)="pan($event)">

        <div *ngFor='let img of images; let j = index'>
          <div *ngIf="img.type == 'PHOTO'"
               class="image"
               [class.active]="img['active']"
               [style.background-image]="img['viewerImageLoaded'] ? 'url('+img[categorySelected]['path']+')' : math.abs(currentIdx-j) <=1 ? 'url('+img['preview_xxs']['path']+')' : ''"
               [style.left]="transform+'px'"
               [@imageTransition]="img['transition']"></div>
        </div>
        
        <div *ngFor='let img of images; let j = index' class="innerContainer">
          <img *ngIf="img.type == 'PHOTO'"
               class="preloading-image"
               (load)="imageLoaded(img)"
               src="{{ math.abs(currentIdx-j) <=1 ? img[categorySelected]['path'] : ''}}"/>
          
          <video *ngIf="img.type == 'VIDEO' && img.active == true"
                 [src]="img['originalDownloadPath']"
                 [class.active]="img['active']"
                 [ngClass]="{'video-portrait-style': videoIsPortrait == true, 'video-landscape-style': videoIsPortrait == false}"
                 autoplay
                 controls></video>

        </div>
    </div>
</div>

